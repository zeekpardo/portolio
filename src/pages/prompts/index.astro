---
import Layout from "../../layouts/Layout.astro";
import {getCollection} from 'astro:content';
import PromptCard from "../../components/PromptCard.astro";

interface Prompt {
    id: string;
    data: {
        title: string;
        description: string;
        category: string;
        tags: string[];
        useCase: string;
        publishDate: Date;
    };
}

const allPrompts = (await getCollection('prompts'))
    .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());

// Group prompts by category
const promptsByCategory = allPrompts.reduce((acc, prompt) => {
    const category = prompt.data.category;
    if (!acc[category]) {
        acc[category] = [];
    }
    acc[category].push(prompt);
    return acc;
}, {} as Record<string, typeof allPrompts>);

const categories = Object.entries(promptsByCategory);
---

<Layout title="Zeek Pardo | AI Prompts" description="A collection of AI prompts used across different projects" scrollSmooth={false}>
    <>
        <!--AI Prompts Section-->
        <section class="border-bottom">
            <div class="mb-4">
                <h2 class="text-3xl font-bold mb-8">All My AI Prompts</h2>
            </div>
        </section>

        <section class="flex flex-col gap-8">
            {allPrompts.length > 0 ? (
                allPrompts.map((prompt: Prompt) => (
                    <PromptCard
                        key={prompt.id}
                        id={prompt.id}
                        title={prompt.data.title}
                        description={prompt.data.description}
                        category={prompt.data.category}
                        tags={prompt.data.tags}
                        useCase={prompt.data.useCase}
                        publishDate={prompt.data.publishDate}
                    />
                ))
            ) : (
                <p>No prompts found.</p>
            )}
        </section>
    </>
</Layout>